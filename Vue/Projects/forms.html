<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conditional Question Display</title>
    <!-- VueJS CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <!-- VueJS App -->
    <div class="container mt-5" id="app">
        <form class="border p-4 rounded shadow-sm">
            <!-- Question 1 -->
            <div v-for="(question, index) in questions" :key="index" class="mb-4">
                <div v-if="question.id === 1">
                    <h5>{{ question.description }}</h5>
                    <div v-if="question.type === 'radio'">
                        <div class="form-check" v-for="(option, optionIndex) in question.options" :key="optionIndex">
                            <input 
                                class="form-check-input" 
                                :id="`radio-${index}-${optionIndex}`" 
                                v-model="answers[question.id]" 
                                :value="option.value" 
                                type="radio" 
                                @change="handleRadioChange(question, option)" 
                            />
                            <label class="form-check-label" :for="`radio-${index}-${optionIndex}`">
                                {{ option.label }}
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Conditional Question 2 -->
                <div v-if="question.id === 2 && showSecondQuestion" class="mt-3">
                    <h5>{{ question.description }}</h5>
                    <input 
                        v-model="answers[question.id]" 
                        type="text" 
                        class="form-control" 
                        placeholder="Please elaborate" 
                    />
                </div>
            </div>
        </form>
    </div>

    <script>
        Vue.createApp({
            data() {
                return {
                    questions: [], // Holds the fetched questions
                    answers: {}, // Tracks user answers
                    showSecondQuestion: false // Tracks visibility of the second question
                }
            },
            mounted() {
                // Fetch questions from JSON file
                fetch('./friendship-form-questions.json')
                    .then(response => response.json())
                    .then(data => {
                        this.questions = data;

                        // Initialize answers object
                        this.questions.forEach(question => {
                            this.answers[question.id] = null;
                        });
                    })
                    .catch(error => console.error('Error fetching questions:', error));
            },
            methods: {
                handleRadioChange(question, option) {
                    // Show the second question only if "Best Friend" is selected for question ID 1
                    if (question.id === 1 && option.value === "Best Friend") {
                        this.showSecondQuestion = true;
                    } else if (question.id === 1) {
                        this.showSecondQuestion = false;
                        this.answers[2] = null; // Reset the answer for question ID 2
                    }
                }
            }
        }).mount("#app");
    </script>
    
    <!-- Bootstrap JS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
